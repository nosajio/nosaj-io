@import 'globals';
@import 'button';
@import 'keyframes';
@import 'easing';
@import 'links';

// Various variables
// The blog width is 4 columns of the grid
$blog-content-width: $g-column * 4 + $g-margin * 3;
// Just occupy the margins on either side of the grid
$blog-media-width: $blog-content-width + ($g-margin * 2);
// Extra narrow - quotes are only 2 columns
$blog-quotes-width: $g-column * 2 + $g-margin;
// Content widths
$blog-font-size: msRem(1);
$blog-font-size-s: 1.1rem;
$blog-line-height: 1.45;
// Animations
$animationDelay: 300ms;
// Colors
$clr-blog-bg: $clr-grey-4;
$clr-blog-text: $clr-black;

%readable {
  max-width: $blog-content-width;
  width: 100%;
  padding: 0 msRem(-2);
  
  @media screen and (min-width: $blog-media-width) {
    margin: 0 auto;
    padding: 0;
  }
}

%media {
  max-width: $blog-media-width;
  width: 100%;
  padding: 0 msRem(-2);
  
  @media screen and (min-width: $blog-media-width) {
    margin: 0 auto;
    padding: 0;
  }
}

.blog-view {
  background: $clr-blog-bg;
  
  // Make the logo use the post color
  .logo svg path {
    fill: $clr-black;
  }
  
  // Global links
  a {
    color: $clr-blog-text;
    @include underline($clr-blog-text, $clr-blue);
    &:hover { color: $clr-blue; }
  }
}

.main-frame {
  display: flex;
  flex-flow: column nowrap;
  margin-top: msRem(10);
  
  @media #{mq(m)} {
    margin-top: msRem(16);
  }
}


// Title block
.blog-post__title {
  @extend %readable;
  margin-bottom: msRem(9);
  
  @media #{mq(m)} {
    margin-bottom: msRem(13);
  }
  
  h1 {
    font-size: msRem(5);
    font-weight: $ff-body-semibold;
  }
}


// Suffix block
.blog-post__suffix {
  @extend %readable;
  font-style: oblique;
  font-size: msRem(2);
  margin-top: msRem(9);
}


// Next post block
.next-post {
  @extend %readable;
  margin: msRem(15) auto;
  
  &__read-next {
    display: block;
    margin-bottom: msRem(-6);
    color: $clr-grey-1;
  }
  
  &__title {
    font-size: msRem(5);
    font-weight: $ff-body-semibold;
  }
}


// Main body of the post
.blog-post__body {
  animation: fade-in 700ms #{$animationDelay + 300ms} 1 both $easeOutCubic;



  // : Links
  
  a {  
    &:link { @include underline($clr-blog-text, $clr-blue, 0.19em); color: $clr-blog-text; }
    &:hover, &:focus { color: $clr-blue; }
    &:visited { 
      color: $clr-deep-purple; 
    }
  }



  // :: Headings
  
  // All headigns start the same for consistency
  h1, h2, h3, h4 {
    @extend %readable;
    display: block;
    margin-top: msRem(9);
    margin-bottom: msRem(1);
    font: $ff-body-semibold $blog-font-size $ff-body;
  }
  
  // H1. this guy is special
  h1 { font-size: msRem(2); }
  
  // Secondary & tertiary headings 
  h2 {
    font-size: msRem(1);
    @media #{mq(m)} { font-size: msRem(2); }
  }
  
  h3, h4 { 
    font-size: $blog-font-size; 
    @media #{mq(m)} { font-size: msRem(1); }
  }
  
  
  
  // :: Body elements
  
  hr {
    display: block;
    width: 100%;
    height: 15px;
    margin: msRem(9) auto;
    border: none;
    text-align: center;
    font-size: msRem(1);
    
    &::before {
      content: "* * *";
      display: inline-block;
      height: 15px;
      font-weight: $ff-body-medium;
      vertical-align: middle;
    }
  }
  
  p {
    @extend %readable;
    font-size: $blog-font-size-s;
    line-height: $blog-line-height;
    margin-top: msRem(1);
    margin-bottom: msRem(1);
    @media #{mq(m)} { font-size: $blog-font-size; }
  }
  
  sup {
    background: #f2f2f2;
    vertical-align: super;
    padding: msRem(-5);
    font: $ff-body-bold 15px $ff-mono;
  }
  
  code {
    padding: msRem(-9);
    border-radius: 3px;
    font: msRem(-1) $ff-mono;
    background: $clr-black;
    color: $clr-green;
  }
  
  // Treat the first paragraph
  p.first-child { 
    margin-top: 0;
  }
  
  // Drop caps
  p.first-child.drop-cap { font-weight: $ff-body-medium; }
  p.first-child.drop-cap::first-letter {
    display: inline-block;
    padding: 0 10px 0 0;
    float: left;
    font-weight: $ff-body-bold;
    font-size: 55px;
    line-height: 55px;
  }
  
  // Centered text
  p.center { text-align: center; }
  
  p strong { font-weight: 500; }
  p em { font-style: italic; }
  
  
  img {
    display: block;
    max-width: 100%;
  }
  
  
  
  // :: Lists
  
  ol, ul {
    @extend %readable;
    display: block;
    margin: msRem(3) auto;
    padding: 0 msRem(4);
    
    li {
      display: list-item;
      font-size: $blog-font-size-s;
      line-height: 1.45;
      
      @media #{mq(m)} {
        font-size: $blog-font-size;
      }
    }
    
    li + li {
      margin-top: msRem(-6);
    }
  }
  
  ol {
    list-style-type: upper-roman;
  }
  
  ul {
    list-style-type: disc; 
    
    li {
      display: list-item;
      margin: 0;
    }
  }
  
  
  
  // :: Custom elements
  // These are elements that are either generated from the markdown (like blockquotes)
  // or elements specified in the Readme.
  
  // Quotes
  cite { display: block; }
  
  // Regular inline <blockquote>
  blockquote {
    width: 100%;
    max-width: $blog-quotes-width;
    margin: msRem(6) auto;
    font-style: oblique;
        
    cite {
      margin-top: msRem(3);
      color: $clr-grey-1;
      font-size: msRem(-1);
    }
    
    cite a { color: $clr-grey-1; @include underline($clr-grey-1, $clr-blue); }
    cite a:hover { color: $clr-blue; }
    
    @media #{mq(m)} {
      margin: msRem(9) auto;
    }
  }

  // Quotets that show before all other content
  .quotes-opener {
    @extend %readable;
    margin-top: 0;
    margin-bottom: msRem(5);
    > blockquote { text-align: center }
    > blockquote + blockquote { margin-top: msRem(4); }
  }
  
  
  // Images, embeds, packages, and boxes
  .image, .video, .embed, .package, .emphasis, .box {
    @extend %media;
    margin-bottom: msRem(9);
  }
  
  p + .image, p + .video, p + .embed, p + .package, p + .emphasis, p + .box { margin-top: msRem(9); }
  
  // Boxes
  // Boxes are just container elements with a background color different 
  // to the body. They're used for incidental or optional content.
  .box {
    background: $clr-grey-3;
    padding: msRem(-1);
    
    & > h1, & > h2, & > h3, & > h4 {
      margin-top: 0;
    }
    
    .image {
      @extend %readable;
    }
  }
  
  // Packages
  // Used as a convenient way of sharing links to things, like code repos 
  // or downloads.
  .package {
    border-radius: 3px;
    background: $clr-black;
    color: white;
    box-shadow: 0 2px 2px rgba(0, 0, 0, .2);
    padding: msRem(-1);
    text-align: center;
    
    p { margin: 0 0 msRem(-2); }
    a { color: black; font-size: 1rem; }
    
    .link, .repo {
      @extend .button;
      display: inline-block;
      color: $clr-black;
      font-weight: 600;
      text-decoration: none;
      
      &:hover {
      }
    }
  }
  
  // Images
  .image {
    img {
      display: block;
      width: 100%;
    }
    
    .caption {
      @extend %readable;
      display: block;
      width: 100%;
      margin-top: msRem(2);
      font-size: msRem(-1);
      color: $clr-grey-1;
    }
    
  }
  
  .image.narrow {
    max-height: 600px;
  }
  
  .image.fill {
    max-width: 100%;
    overflow: hidden;
    padding: 0;
  }
  
  // Embeds
  .embed {
    display: flex;
    justify-content: center;
  }
  
  // Videos
  .video {
    iframe {
      display: block;
      width: 100%;
      max-width: $blog-media-width;
      margin: 0 auto;
    }
  }
}
